name: levit
repository: https://github.com/softilab/levit

packages:
  - benchmarks
  - examples/**
  - packages/**
  - stress_tests

command:
  bootstrap:
    usePubspecOverrides: true

scripts:
  analyze:
    run: dart analyze --fatal-infos
    description: Run static analysis
    exec:
      concurrency: 6

  test:
    run: dart test
    description: Run pure Dart tests
    exec:
      concurrency: 1
    packageFilters:
      dirExists: test
      noDependsOn: flutter
      ignore:
        - levit_stress_tests
        - dev_tool_server

  test:flutter:
    run: flutter test
    description: Run Flutter tests
    exec:
      concurrency: 1
    packageFilters:
      dirExists: test
      dependsOn: flutter
      ignore:
        - levit_stress_tests
        - benchmarks
        - flutter_dev_tool

  coverage:
    run: dart run scripts/check_coverage.dart
    description: Run coverage checks

  stress:
    run: dart run scripts/stress_test.dart
    description: Run stress tests

  benchmarks:
    run: flutter test benchmarks
    description: Run benchmarks

  format:
    run: dart format .
    description: Format all Dart code
    exec:
      concurrency: 6

  # 1. Generate docs for every package
  doc:gen:
    run: dart doc --output=../../../.temp-docs .
    exec:
      # Run this in every package that has a pubspec.yaml and isn't an example
      concurrency: 1
      failFast: true
    packageFilters:
      scope:
        - levit_flutter
